<section class="graphs">
  <nav class="graphs-left-menu w3-hide-small app-theme-primary">
    <ng-container *ngTemplateOutlet="template_graphs_left_menu"></ng-container>
  </nav>
  <section class="graphs-left-menu-small-container w3-hide-medium w3-hide-large">
    <div
      #graphs_left_menu_small_overlay
      class="graphs-left-menu-small-overlay w3-hide"
      (click)="toggleGraphLeftMenuSmallVisibility()"
    ></div>
    <button
      #graphs_left_menu_small_toggle
      mat-icon-button
      color="primary"
      class="graphs-left-menu-small-toggle hamburger hamburger--arrow"
      (click)="toggleGraphLeftMenuSmallVisibility()"
    >
      <span class="hamburger-box">
        <span class="hamburger-inner"></span>
      </span>
    </button>
    <nav #graphs_left_menu_small class="graphs-left-menu-small w3-sidebar w3-animate-left w3-hide app-theme-primary">
      <div class="graphs-left-menu-small-toggle-placeholder"></div>
      <ng-container *ngTemplateOutlet="template_graphs_left_menu"></ng-container>
    </nav>
  </section>

  <section class="graphs-content">
    <ng-container *ngTemplateOutlet="template_quick_links"></ng-container>

    <router-outlet></router-outlet>
  </section>
</section>

<!--Template for menu-->
<ng-template #template_graphs_left_menu>
  <ng-container *ngFor="let menu_group of menu_groups; let i = index">
    <mat-expansion-panel
      *ngIf="menu_group.items && menu_group.items.length > 0; else template_non_group_menu_group"
      class="graphs-left-menu-group app-theme-primary"
      [ngClass]="{
        'graphs-left-menu-group-disabled w3-opacity app-theme-primary-d1': menu_group.disabled
      }"
      [expanded]="active_menu.group == menu_group.id"
      [disabled]="menu_group.disabled"
    >
      <mat-expansion-panel-header class="app-hover-theme-primary">
        <mat-panel-title>
          {{ menu_group.name ? menu_group.name : menu_group.id }}
        </mat-panel-title>
      </mat-expansion-panel-header>

      <ng-container *ngFor="let menu_item of menu_group.items">
        <a
          *ngIf="menu_item.router_link; else template_absolute_menu_item_link"
          class="graphs-left-menu-group-item w3-padding"
          [ngClass]="{
            'graphs-left-menu-group-item-disabled w3-opacity app-theme-primary-d1': menu_item.disabled,
            'graphs-left-menu-group-item-active app-theme-primary-dark': active_menu.item === menu_item.id
          }"
          [routerLink]="menu_item.router_link"
          >{{ menu_item.name ? menu_item.name : menu_item.id }}</a
        >

        <ng-template #template_absolute_menu_item_link>
          <a
            class="graphs-left-menu-group-item graphs-left-menu-group-item-absolute w3-padding"
            [ngClass]="{
              'graphs-left-menu-group-item-disabled w3-opacity app-theme-primary-d1': menu_item.disabled,
              'graphs-left-menu-group-item-active app-theme-primary-dark': active_menu.item === menu_item.id
            }"
            [href]="menu_item.absolute_link"
            >{{ menu_item.name ? menu_item.name : menu_item.id }}</a
          >
        </ng-template>
      </ng-container>

      <mat-divider *ngIf="i !== menu_groups.length - 1" class="w3-margin-top"></mat-divider>
    </mat-expansion-panel>

    <ng-template #template_non_group_menu_group>
      <a
        *ngIf="menu_group.router_link; else template_absolute_menu_group_link"
        class="graphs-left-menu-group graphs-left-menu-group-link"
        [ngClass]="{
          'graphs-left-menu-group-link-disabled w3-opacity app-theme-primary-d1': menu_group.disabled,
          'graphs-left-menu-group-link-active app-theme-primary-dark': active_menu.group === menu_group.id
        }"
        [routerLink]="menu_group.router_link"
        >{{ menu_group.name ? menu_group.name : menu_group.id }}</a
      >

      <ng-template #template_absolute_menu_group_link>
        <a
          class="graphs-left-menu-group graphs-left-menu-group-link graphs-left-menu-group-link-absolute"
          [ngClass]="{
            'graphs-left-menu-group-link-disabled w3-opacity app-theme-primary-d1': menu_group.disabled,
            'graphs-left-menu-group-link-active app-theme-primary-dark': active_menu.group === menu_group.id
          }"
          [href]="menu_group.absolute_link"
          >{{ menu_group.name ? menu_group.name : menu_group.id }}</a
        >
      </ng-template>
    </ng-template>
  </ng-container>
</ng-template>

<!--Template quick links-->
<ng-template #template_quick_links>
  <section *ngIf="!active_menu.group" class="graphs-content-quick-links w3-padding">
    <mat-card class="graphs-content-quick-links-item w3-card" *ngFor="let menu_group of menu_groups">
      <mat-card-header>
        <mat-card-title class="app-text-theme-primary">{{
          menu_group.name ? menu_group.name : menu_group.id
        }}</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <button
          mat-icon-button
          *ngFor="let menu_item of menu_group.items"
          class="graphs-content-quick-links-item-sublink w3-opacity-min"
          [ngClass]="{
            'w3-hover-opacity-off': !menu_item.disabled,
            'w3-greyscale-max': menu_item.disabled
          }"
          [matTooltip]="(menu_item.name ? menu_item.name : menu_item.id) + (menu_item.disabled ? ' (Coming Soon)' : '')"
          (click)="
            onClickQuickLinkSublinks(
              $event,
              !menu_item.disabled ? (menu_item.router_link ? menu_item.router_link : menu_item.absolute_link) : null,
              menu_item.router_link ? false : true
            )
          "
          [disabled]="menu_item.disabled"
        >
          <img
            class="graphs-content-quick-links-item-sublink-image w3-circle"
            [src]="menu_item.icon_path"
            [alt]="menu_item.id"
          />
        </button>
      </mat-card-content>
      <mat-card-actions class="w3-right-align">
        <a
          mat-flat-button
          class="graphs-content-quick-links-item-explore_btn"
          color="primary"
          [routerLink]="[menu_group.id]"
          [disabled]="menu_group.disabled"
          >Explore <fa-icon [icon]="['fas', 'angle-right']"></fa-icon
        ></a>
      </mat-card-actions>
    </mat-card>
  </section>
</ng-template>
